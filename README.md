# API Documentation для игры "Шакал"

## Описание
Это API предназначено для взаимодействия с сервером игры "Шакал". Игроки могут перемещать корабль, а также управлять пиратами, размещать их на клетки игрового поля и взаимодействовать с другими игроками. В этой документации представлены все основные методы для взаимодействия с игрой.

### Авторизация
Для работы с API необходимо использовать **токен пользователя**. Токен можно получить через эндпоинт авторизации и регистрации.

## Методы API

### 1. Авторизация

**POST** `/php/sign_in`

**Описание**: Авторизация уже существующего пользователя, получение токена и списка доступных комнат.

**Тело запроса**:
```json
{
    "login": "player_name",
    "password": "player_password"
}
```

**Ответ**:
```json
{
    "success": true,
    "message": "Вы успешно вошли!",
    "token": "user_token",
    "rooms": [
        {
            "room_id": 1,
            "seats": 4,
            "time_to_move": 30
        }
    ]
}
```

Если произошла ошибка:
```json
{
    "success": false,
    "message": "Неверный логин или пароль."
}
```

### 2. Регистрация

**POST** `/php/sign_up`

**Описание**: Регистрация нового пользователя, получение токена и списка доступных комнат.

**Тело запроса**:
```json
{
    "login": "player_name",
    "password": "player_password"
}
```

**Ответ**:
```json
{
    "success": true,
    "message": "Вы успешно зарегистрированы!",
    "token": "user_token",
    "rooms": [
        {
            "room_id": 1,
            "seats": 4,
            "time_to_move": 30
        }
    ]
}
```

Если произошла ошибка:
```json
{
    "success": false,
    "message": "Ошибка при регистрации."
}
```

### 3. Смена пароля

**POST** `/php/change_password`

**Описание**: Смена пароля пользователя.

**Тело запроса**:
```json
{
    "login": "player_name",
    "old_password": "old_password",
    "new_password": "new_password"
}
```

**Ответ**:
```json
{
    "success": true,
    "message": "Пароль успешно изменен!"
}
```

Если произошла ошибка:
```json
{
    "success": false,
    "message": "Ошибка при изменении пароля."
}
```

### 4. Создание комнаты

**POST** `/php/create_room`

**Описание**: Создание новой игровой комнаты.

**Тело запроса**:
```json
{
    "seats": 4,
    "time_to_move": 30
}
```

**Ответ**:
```json
{
    "success": true,
    "message": "Комната успешно создана!",
    "rooms": [
        {
            "room_id": 1,
            "seats": 4,
            "time_to_move": 30
        }
    ]
}
```

Если произошла ошибка:
```json
{
    "success": false,
    "message": "Ошибка при создании комнаты."
}
```

### 5. Получение списка комнат

**GET** `/php/update_game_list`

**Описание**: Получение списка доступных комнат для игры.

**Ответ**:
```json
{
    "success": true,
    "rooms": [
        {
            "id_room": 1,
            "seats": 4,
            "time_to_move": 30,
            "players_count": 3
        },
        {
            "id_room": 2,
            "seats": 2,
            "time_to_move": 60,
            "players_count": 2
        }
    ]
}
```

Если не удалось получить список комнат:
```json
{
    "error": "Не удалось получить данные о комнатах"
}
```

### 6. Вход в комнату

**POST** `/php/game`

**Описание**: Позволяет игроку войти в выбранную игровую комнату.

**Тело запроса**:
```json
{
    "id_room": 1
}
```

**Ответ**:
```json
{
    "success": true,
    "message": "Вы успешно вошли в игру",
    "room": {
        "id_room": 1,
        "players": ["player1", "player2"]
    }
}
```

Если не удалось войти в комнату:
```json
{
    "success": false,
    "message": "Не удалось добавить игрока в комнату"
}
```

### 7. Перемещение корабля

**POST** `/php/move_ship_and_pirates`

**Описание**: Перемещение корабля игрока в указанную клетку.

**Тело запроса**:
```json
{
    "player_id": 1,
    "target_cell_number": 15
}
```

**Ответ**:
```json
{
    "success": true,
    "result_message": "Корабль перемещен",
    "game_state": {
        "players": ["player1", "player2"],
        "game_status": "ongoing"
    }
}
```

### 8. Перемещение пирата

**POST** `/php/make_move_by_pirate`

**Описание**: Перемещение пирата игрока на указанную клетку.

**Тело запроса**:
```json
{
    "pirate_id": 1,
    "target_cell_number": 15
}
```

**Ответ**:
```json
{
    "success": true,
    "result_message": "Пират перемещен",
    "game_state": {
        "players": ["player1", "player2"],
        "game_status": "ongoing"
    }
}
```

### 9. Обновление игрового поля

**POST** `/php/game_update`

**Описание**: Обновление игрового поля, проверка текущего состояния игры.

**Тело запроса**:
```json
{
    "id_room": 1
}
```

**Ответ**:
```json
{
    "success": true,
    "game_state": {
        "players": ["player1", "player2"],
        "game_status": "ongoing"
    }
}
```

Если не удалось получить данные:
```json
{
    "success": false,
    "message": "Ошибка получения данных"
}
```

### 10. Выход из игры

**POST** `/php/leave_game`

**Описание**: Позволяет игроку покинуть игру.

**Тело запроса**:
```json
{
    "id_room": 1
}
```

**Ответ**:
```json
{
    "success": true,
    "message": "Вы успешно покинули игру"
}
```

Если не удалось покинуть игру:
```json
{
    "success": false,
    "message": "Неизвестная ошибка при выходе из игры"
}
```

## Ошибки
В случае возникновения ошибки, API всегда возвращает объект с полем `error` или `message`, которое описывает проблему, например:
```json
{
    "error": "Не авторизован"
}
```
